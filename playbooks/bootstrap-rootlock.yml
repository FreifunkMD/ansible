- hosts: all
  become_user: root
  become: yes
  tasks:
  - name: ensure sudo is at the latest version
    apt: pkg=sudo state=latest
  - name: Ensure no one is logging in as root directly by not allowing root login
    lineinfile:
      path: /etc/ssh/sshd_config
      state: absent
      regexp: '^PermitRootLogin yes'
  - name: Ensure no one is logging in as root directly by disabling root login altogether
    lineinfile:
      path: /etc/ssh/sshd_config
      line: "PermitRootLogin no"
      regexp: '^PermitRootLogin'
  - name: Disable Password Authentication
    lineinfile:
      path: /etc/ssh/sshd_config
      line: "PasswordAuthentication no"
  - name: lock password for root user
    user:
      name: root
      password_lock: true
